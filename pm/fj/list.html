<!doctype html>
<html>

	<head>
		<meta charset="UTF-8">
		<title></title>
		<meta name="viewport" content="width=device-width,initial-scale=1,minimum-scale=1,maximum-scale=1,user-scalable=no" />
		<link href="../css/mui.min.css" rel="stylesheet" />
	</head>

	<body>
		<script src="../js/mui.min.js"></script>
		<script type="text/javascript">
			mui.init();
			
			function uploadFile(){
			    //文件集合
			    var files=[];
			    //服务器地址
			    var server="http://192.168.11.96:8080/file/upload";
			    var wt=plus.nativeUI.showWaiting();
			    var task=plus.uploader.createUpload(server,
			        {method:"POST"},
			        function(t,status){
			            //上传完成
			            if(status==200){
			                wt.close();
			                console.log("上传成功："+t.responseText);
			                //服务端返回的结果
			                var result = JSON.parse(t.responseText);
			            if(result.success){
			
			            for(var i=0;i<result.datas.length;i++){
			                if(i==result.datas.length-1){
			                    attaIds += result.datas[i];
			                }else{
			                    attaIds += result.datas[i]+",";
			                }
			            }
			
			            console.log("attaIds的值："+attaIds);
			
			            saveWorkReport();
			
			            }else{
			                console.log("上传失败："+status);
			                wt.close();
			            }
			
			            }else{
			                console.log("上传失败："+status);
			                wt.close();
			            }
			        }
			    );
			    //将文件集合添加到上传队列中
			    for(var i=0;i<files.length;i++){
			        var f=files[i];
			        task.addFile(f.path,{key:f.name});
			    }
			    task.start();
			}
			
//          function createUpload() {
//              console.log(111111111);
//              var task = plus.uploader.createUpload( "http://192.168.11.96:8080/file/doFile", 
//                  { method:"POST",blocksize:204800,priority:100 },
//                  function ( t, status ) {
//                      // 上传完成
//                      console.log(t);
//                      if ( status == 200 ) { 
//                          alert( "Upload success: " + t.url );
//                      } else {
//                          alert( "Upload failed: " + status );
//                      }
//                  }
//              );
//              task.addFile('images/touxiang2x.png', {key:"file"} );
//              task.start();
//          }
		</script>
		
		<button onclick="uploadFile();">点我</button>
        
	</body>

</html>