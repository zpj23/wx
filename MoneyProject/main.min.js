var AlertPanel=function(t){function e(){t.call(this),this.initView()}__extends(e,t);var i=(__define,e),n=i.prototype;return n.initView=function(){this.initBG(),this.initBtn(),this.initTf(),this.anchorOffsetX=this.width/2,this.anchorOffsetY=this.height/2,this.x=this.stage.stageWidth/2,this.y=this.stage.stageHeight/2},n.initBG=function(){this._panelBg=new egret.Shape,this._panelBg.graphics.lineStyle(1,6710886,1),this._panelBg.graphics.beginFill(16777215,.9),this._panelBg.graphics.drawRect(0,0,300,200),this._panelBg.graphics.endFill(),this._panelBg.width=300,this._panelBg.height=200,this.addChild(this._panelBg)},n.initBtn=function(){this._btn=new egret.Shape,this._btn.graphics.lineStyle(1,6710886,1),this._btn.graphics.beginFill(16777215),this._btn.graphics.drawRect(0,0,80,40),this._btn.graphics.endFill(),this._btn.width=80,this._btn.height=40,this._btn.x=110,this._btn.y=140,this._btn.touchEnabled=!0,this._btn.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.onClickBtn,this),this.addChild(this._btn),this._btnLabel=new egret.TextField,this._btnLabel.size=20,this._btnLabel.textColor=3355443,this._btnLabel.text="确定",this._btnLabel.width=80,this._btnLabel.height=40,this._btnLabel.bold=!0,this._btnLabel.x=this._btn.x,this._btnLabel.y=this._btn.y,this._btnLabel.textAlign="center",this._btnLabel.verticalAlign="middle",this.addChild(this._btnLabel)},n.initTf=function(){this._msgTf=new egret.TextField,this._msgTf.textAlign="center",this._msgTf.verticalAlign="middle",this._msgTf.width=240,this._msgTf.height=100,this._msgTf.x=30,this._msgTf.y=20,this._msgTf.textColor=5592405,this._msgTf.size=25,this._msgTf.bold=!0,this.addChild(this._msgTf)},e.i=function(){return this._instance||(this._instance=new e),this._instance},n.showErr=function(t){this._msgTf.text=t,egret.MainContext.instance.stage.addChild(this)},n.onClickBtn=function(){egret.MainContext.RUNTIME_HTML5==egret.Capabilities.runtimeType?this.reloadPage():this.hide()},n.reloadPage=function(){location.reload()},n.hide=function(){this.parent&&this.parent.removeChild(this)},e}(egret.DisplayObjectContainer);egret.registerClass(AlertPanel,"AlertPanel");var GameUtils=function(){function t(){}var e=(__define,t);e.prototype;return t.createBitmapByName=function(t){var e=new egret.Bitmap,i=RES.getRes(t);return e.texture=i,e},t.createBitmapFromSheet=function(t,e){void 0===e&&(e="gameRes");var i=RES.getRes(e),n=i.getTexture(t),s=new egret.Bitmap;return s.texture=n,s},t.getTextureFromSheet=function(t,e){void 0===e&&(e="gameRes");var i=RES.getRes(e),n=i.getTexture(t);return n},t.removeChild=function(t){t&&t.parent&&(t.parent.removeElement?t.parent.removeElement(t):t.parent.removeChild(t))},t.addUI=function(t){t&&!t.parent&&GameApp.uiStage.addElement(t)},t.removeUI=function(t){t&&t.parent&&GameApp.uiStage.removeElement(t)},t.removeStarlingSwfUI=function(e){t.removeChild(e)},t.getUrl=function(t){return""!=t?t:""},t.addTouchTapListener=function(t,e,i){var n=-1,s=-1;t.touchEnabled=!0,t.addEventListener(egret.TouchEvent.TOUCH_BEGIN,function(t){n=t.stageX,s=t.stageY},t),t.addEventListener(egret.TouchEvent.TOUCH_END,function(t){Math.abs(n-t.stageX)<10&&Math.abs(s-t.stageY)<10&&e.call(i),n=-1,s=-1},t)},t.fixNumber=function(t){var e="";return t>1e4?(t=Math.floor(t/1e4),e=t.toString()+"w"):e=t.toString(),e},t.lock=function(t){var e=egret.MainContext.instance.stage;e.touchEnabled=e.touchChildren=!1},t.unlock=function(t){var e=egret.MainContext.instance.stage;e.touchEnabled=e.touchChildren=!0},t.replaceTextureByUrl=function(t,e){RES.getResByUrl(t,function(t){e.texture=t},this,RES.ResourceItem.TYPE_IMAGE)},t.getIsTodayFirstIn=function(){var t=new Date,e=window.localStorage.getItem("LoginDate");if(null==e)return e=t.getMonth().toString()+t.getDay().toString(),window.localStorage.setItem("LoginDate",e),!0;var i=t.getMonth().toString()+t.getDay().toString();return window.localStorage.setItem("LoginDate",i),i!=e},t}();egret.registerClass(GameUtils,"GameUtils");var MyButton=function(t){function e(e,i){t.call(this),this._bg=GameUtils.createBitmapFromSheet(e),this.addChild(this._bg),this.title=GameUtils.createBitmapFromSheet(i),null==this.title.texture&&(this.title.texture=RES.getRes(i)),this.title.x=this._bg.width-this.title.width>>1,this.title.y=this._bg.height-this.title.height>>1,this.addChild(this.title)}__extends(e,t);var i=__define,n=e,s=n.prototype;return s.setClick=function(t){this.touchEnabled=!0,this.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onClickEvent,this),this.onClick=t},s.onClickEvent=function(){this.onClick()},s.setTitle=function(t){this.title=GameUtils.createBitmapFromSheet(t)},i(s,"bg",function(){return this._bg},function(t){this._bg=t}),e}(egret.Sprite);egret.registerClass(MyButton,"MyButton");var MyInfo=function(t){function e(){t.apply(this,arguments)}__extends(e,t);var i=(__define,e),n=i.prototype;return e.getInstance=function(){return e._myInfo||(e._myInfo=new e),e._myInfo},n.addBgViewHandler=function(){this.bgImag=GameUtils.createBitmapByName("bgImage"),this.bgImag.width=480,this.bgImag.height=800,this.bgImag.visible=!0},n.setBgVisible=function(t){this.bgImag.visible=t},e._myInfo=null,e}(egret.Sprite);egret.registerClass(MyInfo,"MyInfo");var ShareUtils=function(){function t(){}var e=(__define,t);e.prototype;return t.moreGame=function(){t.isInU9()?location.href="u9time://gamelist":window.open("http://egret-game.b0.upaiyun.com/game.html","_self")},t.shareToWeChat=function(){},t.shareToU9=function(){var e=location.href;e+=""==location.search?"?channel=weixin":"&channel=weixin",e=encodeURIComponent(e);var i="123",n=encodeURIComponent(t.shareDesc),s=t.getUid(),r="u9time://share?uid="+s+"&game_url="+e+"&a="+i+"&msg="+n;s||(r="u9time://share?&game_url="+e+"&a="+i+"&msg="+n),location.href=r},t.shareToBaidu=function(){},t.setUserScore=function(e){t.isInBaidu()},t.rank=function(){t.isInBaidu()},t.setShareInfo=function(e,i){t.shareTitle=e,t.shareDesc=i,t.shareToWeChat()},t.isInWeChat=function(){var t=window.navigator.userAgent;return-1!=t.indexOf("MicroMessenger")},t.isInU9=function(){var t=window.navigator.userAgent;return-1!=t.indexOf("EgretRuntime")&&-1!=t.indexOf("yoyo")},t.isInBaidu=function(){var t=location.href;return-1!=t.indexOf("release_baidu")},t.findLocationProperty=function(t){var e=location.search;if(""==e)return null;e=e.slice(1);for(var i=e.split("&"),n=i.length,s=0;n>s;s++){var r=i[s],a=r.split("=");if(a[0]==t)return a[1]}return null},t.getUid=function(){return t.findLocationProperty("uid")},t.onEnterGame=function(){var e=t.findLocationProperty("app_id"),i=t.findLocationProperty("game_id"),n=t.findLocationProperty("device_id");if(t.isInBaidu()&&(i="8",e="1004"),e&&i){n||(n=egret.localStorage.getItem("device_id"),n||(n=Math.random())),egret.localStorage.setItem("device_id",n);var s="http://statistics.egret-labs.org/api.php?app_id="+e+"&game_id="+i+"&device_id="+n,r=t.findLocationProperty("channel");if(r&&t.isInWeChat()&&(s+="&channel="+r),s){var a=new egret.URLLoader;a.load(new egret.URLRequest(s))}}},t.IconPath="http://egret-game.b0.upaiyun.com/icons/10000008.jpg",t}();egret.registerClass(ShareUtils,"ShareUtils");var SpecialNumber=function(t){function e(){t.call(this),this.gap=0}__extends(e,t);var i=(__define,e),n=i.prototype;return n.setData=function(t){if(this.clear(),""!=t&&null!=t){for(var e=t.split(""),i=0,n=e.length,s=0;n>s;s++){var t=e[s];try{var r=GameUtils.createBitmapFromSheet(t);r&&(r.x=i,i+=r.width+this.gap,this.addChild(r))}catch(a){console.log(a)}}this.anchorOffsetX=this.width/2}},n.clear=function(){for(;this.numChildren;)this.removeChildAt(0)},e}(egret.DisplayObjectContainer);egret.registerClass(SpecialNumber,"SpecialNumber");var Consts=function(){function t(){}var e=(__define,t);e.prototype;return t.GAME_WIDTH=480,t.GAME_HEIGHT=650,t}();egret.registerClass(Consts,"Consts");var EffectLayer=function(){function t(){}var e=(__define,t);e.prototype;return t}();egret.registerClass(EffectLayer,"EffectLayer");var GameControl=function(t){function e(){t.call(this),this.startgame=new StartGameLayer,this.gameScene=new GameSceneLayer,this.gameoverGame=new GameOverLayer}__extends(e,t);var i=(__define,e),n=i.prototype;return e.getInstance=function(){return e._gameControl||(e._gameControl=new e),e._gameControl},n.setStageHandler=function(t){this.currStage=t,this.bgImag=GameUtils.createBitmapByName("bgImage"),this.bgImag.width=480,this.bgImag.height=800,this.currStage.addChild(this.bgImag)},n.startGameHandler=function(){this.gameScene&&this.gameScene.parent&&GameUtils.removeChild(this.gameScene),this.gameoverGame&&this.gameoverGame.parent&&GameUtils.removeChild(this.gameoverGame),this.currStage.addChild(this.startgame),GameApp.xia.visible=!0},n.onGameSceneHandler=function(){this.startgame&&this.startgame.parent&&GameUtils.removeChild(this.startgame),this.gameoverGame&&this.gameoverGame.parent&&GameUtils.removeChild(this.gameoverGame),this.currStage.addChild(this.gameScene),GameApp.xia.visible=!1},n.showGameOverSceneHandler=function(){this.startgame&&this.startgame.parent&&GameUtils.removeChild(this.startgame),this.gameScene&&this.gameScene.parent&&GameUtils.removeChild(this.gameScene),this.currStage.addChild(this.gameoverGame),GameApp.xia.visible=!0},n.getGameOverDisplay=function(){return this.gameoverGame},e._gameControl=null,e}(egret.Sprite);egret.registerClass(GameControl,"GameControl");var GameOverLayer=function(t){function e(){t.call(this),this.init()}__extends(e,t);var i=(__define,e),n=i.prototype;return n.init=function(){this.gameoverbg1=GameUtils.createBitmapFromSheet("bg_wenzi"),this.gameoverbg1.x=76,this.gameoverbg1.y=0,this.addChild(this.gameoverbg1),this.shibaibg=GameUtils.createBitmapFromSheet("shibai"),this.shibaibg.x=140,this.shibaibg.y=84,this.addChild(this.shibaibg),this.maxScoreIm=GameUtils.createBitmapFromSheet("zuigaojilu"),this.maxScoreIm.x=278,this.maxScoreIm.y=248,this.addChild(this.maxScoreIm),this.currScoreIm=GameUtils.createBitmapFromSheet("fenshu"),this.currScoreIm.x=108,this.currScoreIm.y=248,this.addChild(this.currScoreIm),this.tryBtn=new MyButton("btn_y","btn_zaiwan"),this.tryBtn.x=131,this.tryBtn.y=371,this.tryBtn.setClick(this.onTryGameClick),this.addChild(this.tryBtn),this.strutBtn=new MyButton("btn_b","btn_xuanya"),this.strutBtn.x=131,this.strutBtn.y=481,this.addChild(this.strutBtn),this.strutBtn.setClick(this.onStrutGameClik.bind(this)),egret.Capabilities.runtimeType==egret.RuntimeType.NATIVE&&this.removeChild(this.strutBtn),this.scoreNum=new SpecialNumber,this.scoreNum.x=135,this.scoreNum.y=283,this.addChild(this.scoreNum),this.recordNum=new SpecialNumber,this.recordNum.x=327,this.recordNum.y=283,this.addChild(this.recordNum)},n.setGameOverDataHandler=function(t,e){void 0===t&&(t=20),void 0===e&&(e=57),this.scoreNum.setData(t.toString()),this.recordNum.setData(e.toString())},n.onTryGameClick=function(){console.log("try again"),GameControl.getInstance().onGameSceneHandler()},n.onStrutGameClik=function(){console.log("炫耀下~")},n.onStageTouch=function(){var t=this.stage;t.removeEventListener(egret.TouchEvent.TOUCH_BEGIN,this.onStageTouch,this),t.touchChildren=!0,t.removeChild(this.weixinContainer)},e}(egret.Sprite);egret.registerClass(GameOverLayer,"GameOverLayer");var GameSceneLayer=function(t){function e(){t.call(this),this.spaceArr=[50,70,90,110],this.initUI()}__extends(e,t);var i=(__define,e),n=i.prototype;return n.initUI=function(){this.shake1=new Shake,this.shake2=new Shake,this.bg=RES.getRes("bg_qiang");var t=new egret.Bitmap(this.bg);t.mask=new egret.Rectangle(0,Consts.GAME_HEIGHT,Consts.GAME_WIDTH,300),this.addChild(t),this.bgBitmaps=new Array,this.topContianer=new egret.Sprite,this.addChild(this.topContianer),this.topSptite=new egret.Sprite,this.topContianer.addChild(this.topSptite),this.topLine=new egret.Shape,this.topContianer.addChild(this.topLine),this.bottomContianer=new egret.Sprite,this.addChild(this.bottomContianer),this.bottomSptite=new egret.Sprite,this.bottomContianer.addChild(this.bottomSptite),this.bottomLine=new egret.Shape,this.bottomContianer.addChild(this.bottomLine),this.topRects=new Array,this.bottomRects=new Array,this.titleImg=GameUtils.createBitmapFromSheet("bg_shangkuang"),this.addChild(this.titleImg),this.scoreKuang=GameUtils.createBitmapFromSheet("kuang"),this.scoreKuang.x=5,this.addChild(this.scoreKuang),this.lvKuang=GameUtils.createBitmapFromSheet("kuang"),this.lvKuang.scaleX=-1,this.lvKuang.x=466,this.addChild(this.lvKuang),this.maxScore=GameUtils.createBitmapFromSheet("fenshu"),this.maxScore.x=40,this.maxScore.y=15,this.addChild(this.maxScore),this.currLv=GameUtils.createBitmapFromSheet("guanqia"),this.currLv.x=368,this.currLv.y=15,this.addChild(this.currLv),this.lvNum=new SpecialNumber,this.lvNum.x=393,this.lvNum.y=50,this.addChild(this.lvNum),this.recordNum=new SpecialNumber,this.recordNum.x=73,this.recordNum.y=50,this.addChild(this.recordNum),this.currLevel=1,this.currMaxScore=0,this.lvNum.setData(this.currLevel.toString()),this.recordNum.setData(this.currMaxScore.toString()),this.role=new Role,this.addChild(this.role),this.addEventListener(egret.Event.ADDED_TO_STAGE,this.onAdd,this)},n.onAdd=function(){this.dieNum=0,this.score=0,this.currLevel=1,this.refreshScore(),this.initData(),egret.setTimeout(this.start,this,100)},n.refreshScore=function(){this.lvNum.setData(this.currLevel.toString()),this.recordNum.setData(this.score.toString())},n.refurbish=function(){this.initData(),this.start()},n.start=function(){this.stage.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onClick,this),egret.setTimeout(this.shakeRun,this,1e3)},n.shakeRun=function(){this.shake1.run(this.topContianer,5,this.land.bind(this))},n.land=function(){this.stage.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onClick,this),egret.Tween.get(this.topContianer).to({y:0},100).call(function(){this.landOver()}.bind(this))},n.landOver=function(){this.checkState(),this.shake1.run(this.topContianer,3),this.shake2.run(this.bottomContianer,3,this.checkResult.bind(this))},n.checkState=function(){var t=this.getSpace();0==t?this.role.setState(Role.STATE5):t==this.spaceArr[2]?this.role.setState(Role.STATE4):t==this.spaceArr[0]?this.role.setState(Role.STATE3):t==this.spaceArr[1]&&this.role.setState(Role.STATE2),0==t&&this.setRolePos(this.rolePosIndex,-10,4)},n.checkResult=function(){var t=this.getSpace(),e=this;if(0==t){if(this.dieNum++,1==this.dieNum)return this.role.stop(),void egret.setTimeout(function(){GameControl.getInstance().showGameOverSceneHandler(),GameControl.getInstance().getGameOverDisplay().setGameOverDataHandler(e.score,e.currMaxScore)},this,1e3)}else this.currLevel++,this.score+=10,this.score>this.currMaxScore&&(this.currMaxScore=this.score),this.refreshScore();egret.setTimeout(this.refurbish,this,1e3)},n.getSpace=function(){var t=this.topRects[this.rolePosIndex],e=this.bottomRects[this.rolePosIndex];return Consts.GAME_HEIGHT-t.height-e.height},n.onClick=function(t){var e=0,i=this.bottomRects.length;for(e;i>e;e++){var n=this.bottomRects[e];if(t.stageX>n.x&&t.stageX<n.x+n.width){this.setRolePos(e);break}}},n.initData=function(){this.role.setState(Role.STATE1),this.role.play(),this.topRects.splice(0,this.topRects.length),this.bottomRects.splice(0,this.bottomRects.length);for(var t=150,e=60,i=!1,n=8,s=0;n>s;s++){var r=t+10*Math.floor(8*Math.random());if(this.bottomRects.push(new egret.Rectangle(s*e,Consts.GAME_HEIGHT-r,e,r)),r=Consts.GAME_HEIGHT-r,Math.random()<.2||!i&&s==n-1){var a=Math.floor(Math.random()*this.spaceArr.length);r-=this.spaceArr[a],i=!0}this.topRects.push(new egret.Rectangle(s*e,0,e,r))}this.fullFront(this.topSptite,this.topRects),this.fullFront(this.bottomSptite,this.bottomRects,!0),this.drawLine(),this.topContianer.y=-200,this.setRolePos(3,17,0,!0)},n.setRolePos=function(t,e,i,n){void 0===e&&(e=17),void 0===i&&(i=0),void 0===n&&(n=!1),n||(this.rolePosIndex>t?t=this.rolePosIndex-1:this.rolePosIndex<t&&(t=this.rolePosIndex+1)),this.rolePosIndex=t;var s=this.bottomRects[t];this.role.x=s.x+s.width/2+i,this.role.y=s.y+e},n.drawLine=function(){var t=10;this.topLine.graphics.clear(),this.topLine.graphics.lineStyle(t,3401726),this.bottomLine.graphics.clear(),this.bottomLine.graphics.lineStyle(t,3401726),this.drawTopLine(t/2),this.drawBottomLine(t/2),this.topLine.graphics.endFill(),this.bottomLine.graphics.endFill()},n.drawTopLine=function(t){for(var e=this.topRects.length,i=0;e>i;i++){var n=this.topRects[i];0==i?(this.topLine.graphics.moveTo(n.x,n.height),this.topLine.graphics.lineTo(n.x+n.width,n.height)):(this.topLine.graphics.lineTo(n.x,n.height),this.topLine.graphics.lineTo(n.x+n.width,n.height))}},n.drawBottomLine=function(t){for(var e=this.bottomRects.length,i=0;e>i;i++){var n=this.bottomRects[i];0==i?(this.bottomLine.graphics.moveTo(n.x,n.y+t),this.bottomLine.graphics.lineTo(n.x+n.width,n.y+t)):(this.bottomLine.graphics.lineTo(n.x,n.y+t),this.bottomLine.graphics.lineTo(n.x+n.width,n.y+t))}},n.fullFront=function(t,e,i){void 0===i&&(i=!1),t.cacheAsBitmap=!1,this.clearBg(t);for(var n=e.length,s=0;n>s;s++){var r,a=e[s];this.bgBitmaps.length?r=this.bgBitmaps.pop():(r=new egret.Bitmap,r.texture=this.bg),r.scrollRect=a,r.x=a.x,r.y=a.y,t.addChild(r)}},n.clearBg=function(t){for(;t.numChildren;){var e=t.getChildAt(0);e&&(t.removeChild(e),this.bgBitmaps.push(e))}},e}(egret.Sprite);egret.registerClass(GameSceneLayer,"GameSceneLayer");var Invincible=function(t){function e(){t.call(this),this.initUI()}__extends(e,t);var i=(__define,e),n=i.prototype;return n.initUI=function(){this.upContainer=new egret.DisplayObjectContainer,this.upContainer.visible=!1,this.addChild(this.upContainer),this.btnInvincible=new MyButton("btn_y","btn_zaiwan"),this.btnInvincible.setTitle("wudi");var t=GameUtils.createBitmapFromSheet("framebg","newAssets");t.touchEnabled=!1,t.width=this.btnInvincible.width-5,t.height=280,this.upContainer.addChild(t);var e=65,i=80;this.btnOne=new MyButton("btn_b","btn_zaiwan"),this.btnOne.bg.scaleX=this.btnOne.bg.scaleY=.8,this.btnOne.setClick(this.oneTimeClick.bind(this)),this.btnOne.y=i,this.btnOne.setTitle("1ci"),this.upContainer.addChild(this.btnOne),this.btnTwo=new MyButton("btn_b","btn_zaiwan"),this.btnTwo.bg.scaleX=this.btnTwo.bg.scaleY=.8,this.btnTwo.setClick(this.twoTimeClick.bind(this)),this.btnTwo.y=i+e,this.btnTwo.setTitle("2ci"),this.upContainer.addChild(this.btnTwo),this.btnThree=new MyButton("btn_b","btn_zaiwan"),this.btnThree.bg.scaleX=this.btnThree.bg.scaleY=.8,this.btnThree.setClick(this.threeTimeClick.bind(this)),this.btnThree.y=i+2*e,this.btnThree.setTitle("3ci"),this.upContainer.addChild(this.btnThree),this.addChild(this.btnInvincible),t.x=this.width/2-(this.btnInvincible.width-5)/2,this.btnOne.x=this.width/2-this.btnOne.width/2,this.btnTwo.x=this.width/2-this.btnTwo.width/2,this.btnThree.x=this.width/2-this.btnThree.width/2,this.btnInvincible.setClick(this.invincibleClick.bind(this))},n.invincibleClick=function(){this.upContainer.visible=!this.upContainer.visible,this.checkGameScene()},n.oneTimeClick=function(){this.upContainer.visible=!this.upContainer.visible,this.checkGameScene()},n.twoTimeClick=function(){this.upContainer.visible=!this.upContainer.visible,this.checkGameScene()},n.threeTimeClick=function(){this.upContainer.visible=!this.upContainer.visible,this.checkGameScene()},n.removeTouch=function(){this.btnOne.touchEnabled=!1,this.btnTwo.touchEnabled=!1,this.btnThree.touchEnabled=!1},n.addTouch=function(){this.btnOne.touchEnabled=!0,this.btnTwo.touchEnabled=!0,this.btnThree.touchEnabled=!0},n.checkGameScene=function(){this.upContainer.visible},e}(egret.DisplayObjectContainer);egret.registerClass(Invincible,"Invincible");var MapLayer=function(){function t(){}var e=(__define,t);e.prototype;return t}();egret.registerClass(MapLayer,"MapLayer");var PlayerLayer=function(t){function e(){t.call(this),this.playerStateType={},this.playerDirection={},this.playerDirection.center=0,this.playerDirection.left=1,this.playerDirection.right=2,this.playerStateType.normal=0,this.playerStateType.died=1,this.playerStateType.stop=2}__extends(e,t);var i=(__define,e);i.prototype;return e}(egret.Sprite);egret.registerClass(PlayerLayer,"PlayerLayer");var RelivePopup=function(t){function e(){t.call(this),this.addChildAt(this.getMask(),0),this.btnRelive=new MyButton("btn_y","btn_zaiwan"),this.btnRelive.setTitle("fuhuo"),this.btnRelive.x=131,this.btnRelive.y=245,this.btnRelive.setClick(this.onReliveClick),this.addChild(this.btnRelive),this.btnOver=new MyButton("btn_b","btn_zaiwan"),this.btnOver.setTitle("jieshu"),this.btnOver.x=131,this.btnOver.y=351,this.addChild(this.btnOver)}__extends(e,t);var i=(__define,e),n=i.prototype;return n.onReliveClick=function(){},n.getMask=function(){var t=new egret.Sprite;return t.graphics.beginFill(0,.4),t.graphics.drawRect(0,0,Consts.GAME_WIDTH,Consts.GAME_HEIGHT),t.graphics.endFill(),t},e}(egret.DisplayObjectContainer);egret.registerClass(RelivePopup,"RelivePopup");var Role=function(t){function e(){t.call(this),this.currFrameIndex=0,this.body=new egret.Bitmap,this.body.texture=GameUtils.getTextureFromSheet(e.FRAMES[0][0],"roleRes"),console.log(this.body.width),this.body.anchorOffsetX=.5*this.body.width,this.addChild(this.body)}__extends(e,t);var i=(__define,e),n=i.prototype;return n.setState=function(t){this.state=t,this.state==e.STATE5?(this.isLoop=!1,console.log("body height"+this.body.height),this.body.anchorOffsetY=0*this.body.height):(this.isLoop=!0,console.log("isloop body height"+this.body.height),this.body.anchorOffsetY=1*this.body.height),this.state==e.STATE3||this.state==e.STATE4?(this.currFrames=[],Math.random()>.5?this.currFrames.push(e.FRAMES[this.state][0]):this.currFrames.push(e.FRAMES[this.state][1])):this.currFrames=e.FRAMES[this.state],this.currFrameIndex=0,this.setBody()},n.setBody=function(){this.body.texture=GameUtils.getTextureFromSheet(this.currFrames[this.currFrameIndex],"roleRes"),this.body.anchorOffsetX=.5*this.body.width,this.state==e.STATE5?(this.isLoop=!1,console.log("body height"+this.body.height),this.body.anchorOffsetY=0*this.body.height):(this.isLoop=!0,console.log("isloop body height"+this.body.height),this.body.anchorOffsetY=1*this.body.height)},n.run=function(){if(this.runFlag++,this.runFlag>4&&(this.runFlag=0),0==this.runFlag){var t=this.currFrameIndex+1;return t==this.currFrames.length&&(t=this.isLoop?0:this.currFrameIndex),t!=this.currFrameIndex&&(this.currFrameIndex=t,this.setBody()),!1}},n.play=function(){egret.startTick(this.run,this),this.runFlag=0},n.stop=function(){egret.stopTick(this.run,this)},e.STATE1=0,e.STATE2=1,e.STATE3=2,e.STATE4=3,e.STATE5=4,e.FRAMES=[["0020003","0020004","0020005","0020006","0020007"],["0020008"],["0020009","0020010"],["0020011","0020012"],["xue0001","xue0002","xue0003","xue0004","xue0005"]],e}(egret.Sprite);egret.registerClass(Role,"Role");var Shake=function(){function t(){}var e=(__define,t),i=e.prototype;return i.run=function(t,e,i){void 0===i&&(i=null),this.obj=t,this.initY=t.y,this.shakeNum=e,this.overFunc=i,egret.startTick(this.loop,this),this.num=0,this.flag=0},i.loop=function(){return 0==this.flag&&(this.obj.y<=this.initY?this.obj.y+=5:this.obj.y-=5,this.obj.y==this.initY&&(this.num++,this.num==this.shakeNum&&(egret.stopTick(this.loop,this),this.overFunc&&this.overFunc()))),this.flag++,2==this.flag&&(this.flag=0),!1},t}();egret.registerClass(Shake,"Shake");var StartGameLayer=function(t){function e(){t.call(this),this.init()}__extends(e,t);var i=(__define,e),n=i.prototype;return n.init=function(){this.titleImage=GameUtils.createBitmapFromSheet("logo_mishitaosheng"),this.titleImage.x=51,this.titleImage.y=161,this.addChild(this.titleImage),this.startBtn=new MyButton("btn_y","btn_kaishi"),this.startBtn.x=131,this.startBtn.y=324,this.startBtn.setClick(this.onStartGameClick),this.addChild(this.startBtn),this.moreBtn=new MyButton("btn_b","btn_gengduo"),this.moreBtn.x=131,this.moreBtn.y=432,egret.MainContext.RUNTIME_HTML5==egret.Capabilities.runtimeType&&this.addChild(this.moreBtn);var t=new egret.TextField;t.width=Consts.GAME_WIDTH,t.textAlign=egret.HorizontalAlign.CENTER,t.strokeColor=4210238,t.stroke=1,t.bold=!0,t.y=612,t.text="Powered by Egret Engine",this.addChild(t)},n.onStartGameClick=function(){GameControl.getInstance().onGameSceneHandler()},e}(egret.Sprite);egret.registerClass(StartGameLayer,"StartGameLayer");var GameApp=function(t){function e(){t.call(this),this._loadTimes=0,this.addEventListener(egret.Event.ADDED_TO_STAGE,this.onAddToStage,this)}__extends(e,t);var i=(__define,e),n=i.prototype;return n.onAddToStage=function(t){this.loadingView=new LoadingUI,this.stage.addChild(this.loadingView),RES.addEventListener(RES.ResourceEvent.CONFIG_COMPLETE,this.onConfigComplete,this),RES.loadConfig("resource/default.res.json","resource/")},n.onConfigComplete=function(t){RES.removeEventListener(RES.ResourceEvent.CONFIG_COMPLETE,this.onConfigComplete,this),RES.addEventListener(RES.ResourceEvent.GROUP_COMPLETE,this.onResourceLoadComplete,this),RES.addEventListener(RES.ResourceEvent.GROUP_PROGRESS,this.onResourceProgress,this),RES.addEventListener(RES.ResourceEvent.GROUP_LOAD_ERROR,this.onGroupErr,this),RES.loadGroup("preload")},n.onGroupErr=function(t){this._loadTimes++,this._loadTimes>3?AlertPanel.i().showErr("网络异常，请重新进入游戏"):RES.loadGroup(t.groupName)},n.onResourceLoadComplete=function(t){"preload"==t.groupName&&(this.stage.removeChild(this.loadingView),RES.removeEventListener(RES.ResourceEvent.GROUP_COMPLETE,this.onResourceLoadComplete,this),RES.removeEventListener(RES.ResourceEvent.GROUP_PROGRESS,this.onResourceProgress,this),this.createGameScene())},n.onResourceProgress=function(t){"preload"==t.groupName&&this.loadingView.setProgress(t.itemsLoaded,t.itemsTotal)},n.createGameScene=function(){if(egret.MainContext.deviceType==egret.MainContext.DEVICE_MOBILE){var t=GameUtils.createBitmapByName("shang");t.height=this.y,this.stage.addChild(t);var i=GameUtils.createBitmapByName("xia");i.y=this.y+Consts.GAME_HEIGHT,i.height=this.y,this.stage.addChild(i),e.xia=i}GameControl.getInstance().setStageHandler(this),GameControl.getInstance().startGameHandler()},e.xia=new egret.DisplayObject,e}(egret.DisplayObjectContainer);egret.registerClass(GameApp,"GameApp");var LoadingUI=function(t){function e(){t.call(this),this.createView()}__extends(e,t);var i=(__define,e),n=i.prototype;return n.createView=function(){this.textField=new egret.TextField,this.addChild(this.textField),this.textField.y=300,this.textField.width=480,this.textField.height=100,this.textField.textAlign="center"},n.setProgress=function(t,e){this.textField.text="Loading..."+t+"/"+e},e}(egret.Sprite);egret.registerClass(LoadingUI,"LoadingUI");var Main=function(t){function e(){t.call(this),this.addEventListener(egret.Event.ADDED_TO_STAGE,this.onAddToStage,this)}__extends(e,t);var i=(__define,e),n=i.prototype;return n.onAddToStage=function(t){this.loadingView=new LoadingUI,this.stage.addChild(this.loadingView),RES.addEventListener(RES.ResourceEvent.CONFIG_COMPLETE,this.onConfigComplete,this),RES.loadConfig("resource/default.res.json","resource/")},n.onConfigComplete=function(t){RES.removeEventListener(RES.ResourceEvent.CONFIG_COMPLETE,this.onConfigComplete,this),RES.addEventListener(RES.ResourceEvent.GROUP_COMPLETE,this.onResourceLoadComplete,this),RES.addEventListener(RES.ResourceEvent.GROUP_LOAD_ERROR,this.onResourceLoadError,this),RES.addEventListener(RES.ResourceEvent.GROUP_PROGRESS,this.onResourceProgress,this),RES.addEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,this.onItemLoadError,this),RES.loadGroup("preload")},n.onResourceLoadComplete=function(t){"preload"==t.groupName&&(this.stage.removeChild(this.loadingView),RES.removeEventListener(RES.ResourceEvent.GROUP_COMPLETE,this.onResourceLoadComplete,this),RES.removeEventListener(RES.ResourceEvent.GROUP_LOAD_ERROR,this.onResourceLoadError,this),RES.removeEventListener(RES.ResourceEvent.GROUP_PROGRESS,this.onResourceProgress,this),RES.removeEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,this.onItemLoadError,this),this.createGameScene())},n.onItemLoadError=function(t){console.warn("Url:"+t.resItem.url+" has failed to load")},n.onResourceLoadError=function(t){console.warn("Group:"+t.groupName+" has failed to load"),this.onResourceLoadComplete(t)},n.onResourceProgress=function(t){"preload"==t.groupName&&this.loadingView.setProgress(t.itemsLoaded,t.itemsTotal)},n.createGameScene=function(){var t=this.createBitmapByName("bgImage");this.addChild(t);var e=this.stage.stageWidth,i=this.stage.stageHeight;t.width=e,t.height=i;var n=new egret.Shape;n.graphics.beginFill(0,.5),n.graphics.drawRect(0,0,e,i),n.graphics.endFill(),n.width=e,n.height=i,this.addChild(n);var s=this.createBitmapByName("egretIcon");this.addChild(s),s.scaleX=.55,s.scaleY=.55,s.anchorOffsetX=s.width/2,s.anchorOffsetY=s.height/2,s.x=e/2,s.y=i/2-60;var r=new egret.TextField;r.textColor=16777215,r.textAlign="center",r.text="Hello Egret",r.size=20,r.x=e-r.width>>1,r.y=(i-r.height>>1)+50,this.addChild(r);var a=new egret.TextField;this.addChild(a),a.alpha=0,a.width=e,a.textAlign=egret.HorizontalAlign.CENTER,a.x=0,a.y=i/2+100,this.textfield=a,RES.getResAsync("description",this.startAnimation,this)},n.createBitmapByName=function(t){var e=new egret.Bitmap,i=RES.getRes(t);return e.texture=i,e},n.startAnimation=function(t){for(var e=this,i=new egret.HtmlTextParser,n=[],s=0;s<t.length;s++)n.push(i.parser(t[s]));var r=e.textfield,a=-1,h=function(){a++,a>=n.length&&(a=0);var t=n[a];e.changeDescription(r,t);var i=egret.Tween.get(r);i.to({alpha:1},200),i.wait(2e3),i.to({alpha:0},200),i.call(h,e)};h()},n.changeDescription=function(t,e){t.textFlow=e},e}(egret.DisplayObjectContainer);egret.registerClass(Main,"Main");